import{u as w,a as S,r as i,j as r,L as u,y as c}from"./index-CDtZe3id.js";import{a as A}from"./asignaturaService-DmxOcZI9.js";import{c as E}from"./carreraService-qtl1_GFQ.js";import{C as p}from"./CustomButton-BHk0TsfB.js";import{u as F}from"./index.esm-CYe7NKTW.js";import{o as k,c as q,a as l}from"./index.esm-DVNFl3iM.js";const L=q().shape({name:l().required("El nombre de la asignatura es requerido."),description:l().nullable(),carrera:l().required("La carrera es requerida.").matches(/^[0-9a-fA-F]{24}$/,"ID de carrera inválido.")}),P=()=>{const m=w(),{hasRole:b}=S(),[n,d]=i.useState(!1),[g,h]=i.useState([]),[f,x]=i.useState(!0),{register:o,handleSubmit:j,formState:{errors:s}}=F({resolver:k(L)}),t=b(["admin"]);i.useEffect(()=>{t?(async()=>{try{const N=(await E.getCarreras()).sort((v,C)=>v.name.localeCompare(C.name));h(N)}catch(a){console.error("Error fetching carreras:",a),c.error("Error al cargar las carreras.")}finally{x(!1)}})():x(!1)},[t]);const y=async e=>{if(!t){c.error("No tienes permiso para crear asignaturas.");return}try{d(!0),await A.createAsignatura(e),c.success("Asignatura creada exitosamente."),m("/admin/asignaturas")}catch(a){console.error("Error creating asignatura:",a),c.error(a.response?.data?.message||"Error al crear la asignatura.")}finally{d(!1)}};return t?f?r.jsxs("div",{className:"pt-20 flex flex-col items-center justify-center min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:[r.jsx(u,{}),r.jsx("p",{className:"mt-4",children:"Cargando carreras..."})]}):r.jsx("div",{className:"mt-28 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:r.jsxs("div",{className:"max-w-[1024px] mx-auto",children:[r.jsx("h1",{className:"text-3xl font-bold mb-6 text-center w-full",children:"Crear Nueva Asignatura"}),r.jsx("div",{className:"bg-bg-secondary p-8 rounded-lg shadow-lg w-full max-w-md mx-auto border border-border-color",children:r.jsxs("form",{onSubmit:j(y),className:"flex flex-col gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-text-primary text-sm font-bold mb-2",htmlFor:"name",children:"Nombre de la Asignatura:"}),r.jsx("input",{type:"text",id:"name",...o("name"),className:"w-full px-3 py-2 border rounded-md bg-input-bg text-text-primary border-input-border"}),s.name&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.name.message})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-text-primary text-sm font-bold mb-2",htmlFor:"description",children:"Descripción (opcional):"}),r.jsx("textarea",{id:"description",...o("description"),className:"w-full px-3 py-2 border rounded-md bg-input-bg text-text-primary border-input-border",rows:"3"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-text-primary text-sm font-bold mb-2",htmlFor:"carrera",children:"Carrera:"}),r.jsxs("select",{id:"carrera",...o("carrera"),className:"w-full px-3 py-2 border rounded-md bg-input-bg text-text-primary border-input-border",children:[r.jsx("option",{value:"",children:"Selecciona una carrera"}),g.map(e=>r.jsx("option",{value:e._id,children:e.name},e._id))]}),s.carrera&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.carrera.message})]}),r.jsxs("div",{className:"flex justify-end gap-4 mt-4",children:[r.jsx(p,{variant:"secondary",className:"cursor-pointer",onClick:()=>m("/admin/asignaturas"),disabled:n,children:"Cancelar"}),r.jsx(p,{variant:"primary",className:"cursor-pointer",type:"submit",disabled:n,children:n?r.jsx(u,{}):"Crear Asignatura"})]})]})})]})}):r.jsxs("div",{className:"pt-20 flex flex-col items-center justify-center min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:[r.jsx("h1",{className:"text-3xl font-bold mb-4 text-red-500",children:"Acceso Denegado"}),r.jsx("p",{className:"text-lg",children:"No tienes permiso para crear asignaturas."})]})};export{P as default};
