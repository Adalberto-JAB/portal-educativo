import{b as E,u as F,a as L,r as t,j as a,L as b,y as n}from"./index-CDtZe3id.js";import{a as h}from"./asignaturaService-DmxOcZI9.js";import{c as D}from"./carreraService-qtl1_GFQ.js";import{C as f}from"./CustomButton-BHk0TsfB.js";import{u as k}from"./index.esm-CYe7NKTW.js";import{o as q,c as z,a as d}from"./index.esm-DVNFl3iM.js";const _=z().shape({name:d().required("El nombre de la asignatura es requerido."),description:d().nullable(),carrera:d().required("La carrera es requerida.").matches(/^[0-9a-fA-F]{24}$/,"ID de carrera inválido.")}),H=()=>{const{id:c}=E(),m=F(),{hasRole:j}=L(),[o,u]=t.useState(!1),[y,x]=t.useState(!0),[N,v]=t.useState([]),[A,p]=t.useState(!0),{register:l,handleSubmit:w,formState:{errors:s},reset:g}=k({resolver:q(_)}),i=j(["admin"]);t.useEffect(()=>{(async()=>{if(!i){x(!1),p(!1);return}try{const r=await h.getAsignaturaById(c);g({name:r.name,description:r.description,carrera:r.carrera?._id});const S=await D.getCarreras();v(S)}catch(r){console.error("Error fetching data:",r),n.error("Error al cargar los datos de la asignatura o las carreras.")}finally{x(!1),p(!1)}})()},[c,i,g]);const C=async e=>{if(!i){n.error("No tienes permiso para editar asignaturas.");return}try{u(!0),await h.updateAsignatura(c,e),n.success("Asignatura actualizada exitosamente."),m("/admin/asignaturas")}catch(r){console.error("Error updating asignatura:",r),n.error(r.response?.data?.message||"Error al actualizar la asignatura.")}finally{u(!1)}};return i?y||A?a.jsxs("div",{className:"pt-20 flex flex-col items-center justify-center min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:[a.jsx(b,{}),a.jsx("p",{className:"mt-4",children:"Cargando datos de la asignatura..."})]}):a.jsx("div",{className:"mt-28 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:a.jsxs("div",{className:"max-w-[1024px] mx-auto",children:[a.jsx("h1",{className:"text-3xl font-bold mb-6 text-center w-full",children:"Editar Asignatura"}),a.jsx("div",{className:"bg-bg-secondary p-8 rounded-lg shadow-lg w-full max-w-md mx-auto border border-border-color",children:a.jsxs("form",{onSubmit:w(C),className:"flex flex-col gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-text-primary text-sm font-bold mb-2",htmlFor:"name",children:"Nombre de la Asignatura:"}),a.jsx("input",{type:"text",id:"name",...l("name"),className:"w-full px-3 py-2 border rounded-md bg-input-bg text-text-primary border-input-border"}),s.name&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.name.message})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-text-primary text-sm font-bold mb-2",htmlFor:"description",children:"Descripción (opcional):"}),a.jsx("textarea",{id:"description",...l("description"),className:"w-full px-3 py-2 border rounded-md bg-input-bg text-text-primary border-input-border",rows:"3"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-text-primary text-sm font-bold mb-2",htmlFor:"carrera",children:"Carrera:"}),a.jsxs("select",{id:"carrera",...l("carrera"),className:"w-full px-3 py-2 border rounded-md bg-input-bg text-text-primary border-input-border",children:[a.jsx("option",{value:"",children:"Selecciona una carrera"}),N.map(e=>a.jsx("option",{value:e._id,children:e.name},e._id))]}),s.carrera&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.carrera.message})]}),a.jsxs("div",{className:"flex justify-end gap-4 mt-4",children:[a.jsx(f,{variant:"secondary",className:"cursor-pointer",onClick:()=>m("/admin/asignaturas"),disabled:o,children:"Cancelar"}),a.jsx(f,{variant:"primary",className:"cursor-pointer",type:"submit",disabled:o,children:o?a.jsx(b,{}):"Actualizar Asignatura"})]})]})})]})}):a.jsxs("div",{className:"pt-20 flex flex-col items-center justify-center min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:[a.jsx("h1",{className:"text-3xl font-bold mb-4 text-red-500",children:"Acceso Denegado"}),a.jsx("p",{className:"text-lg",children:"No tienes permiso para editar asignaturas."})]})};export{H as default};
