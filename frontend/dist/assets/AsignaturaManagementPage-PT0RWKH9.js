import{u as E,r as s,a as S,j as e,L as B,Q as L,J as M,K as F,y as I}from"./index-CDtZe3id.js";import{a as N}from"./asignaturaService-DmxOcZI9.js";import{C as p}from"./CustomButton-BHk0TsfB.js";import{S as u}from"./sweetalert2.esm.all-CH_YVA8w.js";const R=()=>{const g=E(),[a,y]=s.useState([]),[v,r]=s.useState(!0),[j,l]=s.useState(null),{hasRole:w}=S(),[n,o]=s.useState(1),[i,C]=s.useState(10),d=w(["admin"]),f=async()=>{try{r(!0);const h=(await N.getAllAsignaturas()).sort((c,P)=>c.name.localeCompare(P.name));y(h),l(null)}catch(t){console.error("Error fetching asignaturas:",t),l("No se pudieron cargar las asignaturas. Por favor, inténtalo de nuevo más tarde."),I.error("Error al cargar las asignaturas.")}finally{r(!1)}};s.useEffect(()=>{d?f():(r(!1),l("No tienes permiso para ver esta página."))},[d]);const k=t=>{u.fire({title:"¿Estás seguro?",text:"No podrás revertir esta acción.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, ¡eliminar!",cancelButtonText:"Cancelar"}).then(async h=>{if(h.isConfirmed)try{r(!0),await N.deleteAsignatura(t),u.fire("¡Eliminada!","La asignatura ha sido eliminada.","success"),f()}catch(c){console.error("Error deleting asignatura:",c),u.fire("Error",c.response?.data?.message||"Error al eliminar la asignatura.","error")}finally{r(!1)}})},x=n*i,b=x-i,A=a.slice(b,x),m=Math.ceil(a.length/i);return v?e.jsxs("div",{className:"pt-20 flex flex-col items-center justify-center min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:[e.jsx(B,{}),e.jsx("p",{className:"mt-4",children:"Cargando asignaturas..."})]}):j?e.jsxs("div",{className:"pt-20 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4 text-red-500",children:"Error"}),e.jsx("p",{className:"text-lg",children:j})]}):d?e.jsx("div",{className:"mt-28 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:e.jsxs("div",{className:"max-w-[1024px] mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold text-center w-full mb-4",children:"Gestión de Asignaturas"}),e.jsx("div",{className:"flex justify-end-safe mb-8",children:e.jsxs(p,{variant:"primary",onClick:()=>g("/admin/asignaturas/create"),children:[e.jsx(L,{className:"inline-block mr-2"})," Crear Nueva Asignatura"]})}),a.length===0?e.jsx("div",{className:"text-center text-text-secondary",children:e.jsx("p",{children:"No hay asignaturas disponibles en este momento."})}):e.jsxs("div",{className:"bg-bg-secondary p-6 rounded-lg shadow-md border border-border-color",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Listado de Asignaturas"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("label",{htmlFor:"itemsPerPage",className:"mr-2",children:"Items por página:"}),e.jsxs("select",{id:"itemsPerPage",value:i,onChange:t=>{C(Number(t.target.value)),o(1)},className:"bg-bg-secondary border border-border-color rounded-md p-1",children:[e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:50,children:"50"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-border-color",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Nombre"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Descripción"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Carrera"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Acciones"})]})}),e.jsx("tbody",{className:"bg-bg-secondary divide-y divide-border-color",children:A.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 text-text-primary max-w-xs break-words",children:t.name}),e.jsx("td",{className:"px-6 py-4 text-text-secondary max-w-xs break-words",children:t.description||"N/A"}),e.jsx("td",{className:"px-6 py-4 text-text-secondary max-w-xs break-words",children:t.carrera?t.carrera.name:"N/A"}),e.jsxs("td",{className:"px-6 py-4 text-right text-sm font-medium",children:[e.jsx("a",{onClick:()=>g(`/admin/asignaturas/edit/${t._id}`),className:"text-accent-primary hover:text-blue-700 mr-3 cursor-pointer",children:e.jsx(M,{className:"inline-block mr-1"})}),e.jsx("button",{onClick:()=>k(t._id),className:"text-red-600 hover:text-red-900",children:e.jsx(F,{className:"inline-block mr-1"})})]})]},t._id))})]})}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-text-secondary",children:["Mostrando ",b+1," a ",Math.min(x,a.length)," de ",a.length," asignaturas"]})}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(p,{onClick:()=>o(t=>Math.max(t-1,1)),disabled:n===1,variant:"secondary",children:"Anterior"}),e.jsxs("span",{className:"mx-4",children:["Página ",n," de ",m]}),e.jsx(p,{onClick:()=>o(t=>Math.min(t+1,m)),disabled:n===m,variant:"secondary",children:"Siguiente"})]})]})]})]})}):e.jsxs("div",{className:"pt-20 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4 text-red-500",children:"Acceso Denegado"}),e.jsx("p",{className:"text-lg",children:"No tienes permiso para ver esta página."})]})};export{R as default};
