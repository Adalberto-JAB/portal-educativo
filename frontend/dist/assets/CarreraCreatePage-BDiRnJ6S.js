import{u as v,a as C,r as i,j as e,L as h,y as o}from"./index-CDtZe3id.js";import{c as w}from"./carreraService-qtl1_GFQ.js";import{f as S}from"./facultadService-BYypkmnv.js";import{C as b}from"./CustomButton-BHk0TsfB.js";import{u as E}from"./index.esm-CYe7NKTW.js";import{o as F,c as k,a as m}from"./index.esm-DVNFl3iM.js";const q=k().shape({name:m().required("El nombre de la carrera es requerido"),description:m().nullable(),facultad:m().required("La facultad es requerida")}),$=()=>{const x=v(),{hasRole:g}=C(),[t,s]=i.useState(!0),[u,j]=i.useState([]),[p,n]=i.useState(null),{register:d,handleSubmit:y,formState:{errors:l},setValue:f}=E({resolver:F(q)}),c=g(["admin"]);i.useEffect(()=>{(async()=>{if(!c){s(!1),n("No tienes permiso para crear carreras.");return}try{const r=await S.getFacultades();j(r),r.length>0&&f("facultad",r[0]._id),n(null)}catch(r){console.error("Error fetching facultades:",r),n("No se pudieron cargar las facultades. Por favor, inténtalo de nuevo más tarde."),o.error("Error al cargar las facultades.")}finally{s(!1)}})()},[c,f]);const N=async a=>{if(!c){o.error("No tienes permiso para crear carreras.");return}try{s(!0),await w.createCarrera(a),o.success("Carrera creada exitosamente."),x("/admin/carreras")}catch(r){console.error("Error creating carrera:",r),o.error(r.response?.data?.message||"Error al crear la carrera.")}finally{s(!1)}};return t?e.jsxs("div",{className:"pt-20 flex flex-col items-center justify-center min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:[e.jsx(h,{}),e.jsx("p",{className:"mt-4",children:"Cargando formulario..."})]}):p?e.jsxs("div",{className:"pt-20 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4 text-red-500",children:"Error"}),e.jsx("p",{className:"text-lg",children:p})]}):c?e.jsx("div",{className:"mt-28 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:e.jsxs("div",{className:"max-w-[1024px] mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 text-center w-full",children:"Crear Nueva Carrera"}),e.jsx("div",{className:"bg-bg-secondary p-8 rounded-lg shadow-lg w-full max-w-md mx-auto border border-border-color",children:e.jsxs("form",{onSubmit:y(N),className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-text-primary text-sm font-bold mb-2",htmlFor:"name",children:"Nombre de la Carrera:"}),e.jsx("input",{type:"text",id:"name",...d("name"),className:"w-full px-3 py-2 border rounded-md bg-input-bg text-text-primary border-input-border"}),l.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-text-primary text-sm font-bold mb-2",htmlFor:"description",children:"Descripción (opcional):"}),e.jsx("textarea",{id:"description",...d("description"),className:"w-full px-3 py-2 border rounded-md bg-input-bg text-text-primary border-input-border",rows:"3"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-text-primary text-sm font-bold mb-2",htmlFor:"facultad",children:"Facultad:"}),e.jsx("select",{id:"facultad",...d("facultad"),className:"w-full px-3 py-2 border rounded-md bg-input-bg text-text-primary border-input-border",children:u.length===0?e.jsx("option",{value:"",children:"Cargando facultades..."}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",children:"Selecciona una facultad"}),u.map(a=>e.jsx("option",{value:a._id,children:a.name},a._id))]})}),l.facultad&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.facultad.message})]}),e.jsxs("div",{className:"flex justify-end gap-4 mt-4",children:[e.jsx(b,{variant:"secondary",className:"cursor-pointer",onClick:()=>x("/admin/carreras"),disabled:t,children:"Cancelar"}),e.jsx(b,{variant:"primary",className:"cursor-pointer",type:"submit",disabled:t,children:t?e.jsx(h,{}):"Crear Carrera"})]})]})})]})}):e.jsxs("div",{className:"pt-20 flex flex-col items-center justify-center min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4 text-red-500",children:"Acceso Denegado"}),e.jsx("p",{className:"text-lg",children:"No tienes permiso para crear carreras."})]})};export{$ as default};
