import{u as S,r as t,a as A,j as e,L as B,Q as F,J as L,K as M,y as I}from"./index-CDtZe3id.js";import{c as y}from"./carreraService-qtl1_GFQ.js";import{C as p}from"./CustomButton-BHk0TsfB.js";import{S as u}from"./sweetalert2.esm.all-CH_YVA8w.js";const O=()=>{const g=S(),[a,N]=t.useState([]),[v,s]=t.useState(!0),[j,l]=t.useState(null),{hasRole:C}=A(),[i,o]=t.useState(1),[n,w]=t.useState(10),d=C(["admin"]),f=async()=>{try{s(!0);const h=(await y.getCarreras()).sort((c,k)=>c.name.localeCompare(k.name));N(h),l(null)}catch(r){console.error("Error fetching carreras:",r),l("No se pudieron cargar las carreras. Por favor, inténtalo de nuevo más tarde."),I.error("Error al cargar las carreras.")}finally{s(!1)}};t.useEffect(()=>{d?f():(s(!1),l("No tienes permiso para ver esta página."))},[d]);const E=r=>{u.fire({title:"¿Estás seguro?",text:"No podrás revertir esta acción.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, ¡eliminar!",cancelButtonText:"Cancelar"}).then(async h=>{if(h.isConfirmed)try{s(!0),await y.deleteCarrera(r),u.fire("¡Eliminada!","La carrera ha sido eliminada.","success"),f()}catch(c){console.error("Error deleting carrera:",c),u.fire("Error",c.response?.data?.message||"Error al eliminar la carrera.","error")}finally{s(!1)}})},x=i*n,b=x-n,P=a.slice(b,x),m=Math.ceil(a.length/n);return v?e.jsxs("div",{className:"pt-20 flex flex-col items-center justify-center min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:[e.jsx(B,{}),e.jsx("p",{className:"mt-4",children:"Cargando carreras..."})]}):j?e.jsxs("div",{className:"pt-20 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4 text-red-500",children:"Error"}),e.jsx("p",{className:"text-lg",children:j})]}):d?e.jsx("div",{className:"mt-28 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:e.jsxs("div",{className:"max-w-[1024px] mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold text-center w-full mb-4",children:"Gestión de Carreras"}),e.jsx("div",{className:"flex justify-end-safe mb-8",children:e.jsxs(p,{variant:"primary",onClick:()=>g("/admin/carreras/create"),children:[e.jsx(F,{className:"inline-block mr-2"})," Crear Nueva Carrera"]})}),a.length===0?e.jsx("div",{className:"text-center text-text-secondary",children:e.jsx("p",{children:"No hay carreras disponibles en este momento."})}):e.jsxs("div",{className:"bg-bg-secondary p-6 rounded-lg shadow-md border border-border-color",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Listado de Carreras"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("label",{htmlFor:"itemsPerPage",className:"mr-2",children:"Items por página:"}),e.jsxs("select",{id:"itemsPerPage",value:n,onChange:r=>{w(Number(r.target.value)),o(1)},className:"bg-bg-secondary border border-border-color rounded-md p-1",children:[e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:50,children:"50"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-border-color",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Nombre"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Descripción"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Facultad"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Acciones"})]})}),e.jsx("tbody",{className:"bg-bg-secondary divide-y divide-border-color",children:P.map(r=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 text-text-primary break-words",children:r.name}),e.jsx("td",{className:"px-6 py-4 text-text-secondary break-words",children:r.description||"N/A"}),e.jsx("td",{className:"px-6 py-4 text-text-primary break-words",children:r.facultad?r.facultad.name:"N/A"}),e.jsxs("td",{className:"px-6 py-4 text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>g(`/admin/carreras/edit/${r._id}`),className:"text-accent-primary hover:text-blue-700 mr-4",title:"Editar",children:e.jsx(L,{size:18})}),e.jsx("button",{onClick:()=>E(r._id),className:"text-red-600 hover:text-red-900",title:"Eliminar",children:e.jsx(M,{size:18})})]})]},r._id))})]})}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-text-secondary",children:["Mostrando ",b+1," a ",Math.min(x,a.length)," de ",a.length," carreras"]})}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(p,{onClick:()=>o(r=>Math.max(r-1,1)),disabled:i===1,variant:"secondary",children:"Anterior"}),e.jsxs("span",{className:"mx-4",children:["Página ",i," de ",m]}),e.jsx(p,{onClick:()=>o(r=>Math.min(r+1,m)),disabled:i===m,variant:"secondary",children:"Siguiente"})]})]})]})]})}):e.jsxs("div",{className:"pt-20 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4 text-red-500",children:"Acceso Denegado"}),e.jsx("p",{className:"text-lg",children:"No tienes permiso para ver esta página."})]})};export{O as default};
