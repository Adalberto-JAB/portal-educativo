import{u as q,a as D,r as x,j as e,L as S,y as p}from"./index-CDtZe3id.js";import{c as F}from"./conferenceService-Bcx88bEU.js";import{c as P}from"./coverService-mfvIq_ty.js";import{C as N}from"./CustomButton-BHk0TsfB.js";import{u as I,C as w}from"./index.esm-CYe7NKTW.js";import{o as R,c as U,a as l,d as z,f as V,e as y}from"./index.esm-DVNFl3iM.js";const T=U().shape({title:l().required("El título es requerido"),topic:l(),audience:l(),type:l().oneOf(["Presencial","Virtual"]).required("El tipo es requerido"),organizer:l().required("El nombre del organizador es requerido"),speakers:l(),startDate:l().required("La fecha es requerida"),duration:y().typeError("La duración debe ser un número").positive("La duración debe ser un número positivo").integer().required("La duración es requerida"),cost:y().typeError("El costo debe ser un número").min(0,"El costo no puede ser negativo").default(0),isFree:V(),coverImage:z().nullable(),url:l().when("type",(i,n)=>i&&i[0]==="Virtual"?n.url("Debe ser una URL válida").required("La URL es requerida para eventos virtuales"):n.nullable()),phoneNumber:l()}),K=()=>{const i=q(),{user:n,hasRole:k}=D(),[m,f]=x.useState(!1),[h,j]=x.useState(null),{register:r,handleSubmit:C,formState:{errors:a},watch:u,control:g}=I({resolver:R(T),defaultValues:{type:"Presencial",isFree:!0,cost:0}}),v=k(["admin","teacher"]),d=u("coverImage"),E=u("type")==="Virtual";x.useEffect(()=>{if(d&&d[0]){const s=d[0],t=URL.createObjectURL(s);return j(t),()=>URL.revokeObjectURL(t)}else j(null)},[d]);const L=async s=>{if(!v){p.error("No tienes permiso para crear congresos.");return}f(!0);try{let t=null;if(s.coverImage&&s.coverImage[0]){const o=new FormData;o.append("image",s.coverImage[0]),o.append("name",`conference_cover_${Date.now()}`),o.append("isGeneric","false"),o.append("idUser",n.id),t=(await P.createCover(o))._id}const c={...s,speakers:s.speakers?s.speakers.split(",").map(o=>o.trim()):[],cover:t||void 0};c.type!=="Virtual"&&delete c.url,await F.createConference(c),p.success("Congreso creado exitosamente."),i("/events")}catch(t){console.error("Error creating conference:",t),p.error(t.response?.data?.message||"Error al crear el congreso.")}finally{f(!1)}};return v?e.jsx("div",{className:"mt-28 p-8 min-h-screen bg-bg-primary text-text-primary",children:e.jsxs("div",{className:"max-w-[1024px] mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 text-center w-full",children:"Crear Nuevo Congreso/Evento"}),e.jsx("div",{className:"bg-bg-secondary p-8 rounded-lg shadow-lg w-full max-w-4xl mx-auto border border-border-color",children:e.jsxs("form",{onSubmit:C(L),className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-2",children:"Título"}),e.jsx("input",{...r("title"),className:"w-full input-class"}),a.title&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.title.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-2",children:"Tema/Tópico"}),e.jsx("input",{...r("topic"),className:"w-full input-class"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-2",children:"Dirigido a"}),e.jsx("input",{...r("audience"),className:"w-full input-class"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-2",children:"Organizador"}),e.jsx("input",{...r("organizer"),className:"w-full input-class"}),a.organizer&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.organizer.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-2",children:"Tipo"}),e.jsxs("select",{...r("type"),className:"w-full input-class",children:[e.jsx("option",{value:"Presencial",children:"Presencial"}),e.jsx("option",{value:"Virtual",children:"Virtual"})]})]}),E&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-2",children:"URL del Evento"}),e.jsx("input",{...r("url"),className:"w-full input-class",placeholder:"https://ejemplo.com/evento"}),a.url&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.url.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-2",children:"Ponentes (separados por comas)"}),e.jsx("input",{...r("speakers"),className:"w-full input-class"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-2",children:"Teléfono de Contacto"}),e.jsx("input",{...r("phoneNumber"),className:"w-full input-class"})]})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-2",children:"Fecha de Inicio"}),e.jsx("input",{type:"datetime-local",...r("startDate"),className:"w-full input-class"}),a.startDate&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.startDate.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-2",children:"Duración (en minutos)"}),e.jsx("input",{type:"number",...r("duration"),className:"w-full input-class"}),a.duration&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.duration.message})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsx("label",{className:"block text-sm font-bold",children:"¿Es Gratuito?"}),e.jsx(w,{name:"isFree",control:g,render:({field:s})=>e.jsx("input",{type:"checkbox",...s,checked:s.value,className:"h-5 w-5"})})]}),e.jsx(w,{name:"cost",control:g,render:({field:{onChange:s,value:t},fieldState:{error:c}})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-2",children:"Costo"}),e.jsx("input",{type:"number",value:t,onChange:s,disabled:u("isFree"),className:"w-full input-class disabled:bg-gray-600"}),c&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:c.message})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-2",children:"Imagen de Portada (Opcional)"}),e.jsx("input",{type:"file",...r("coverImage"),accept:".png, .jpg, .jpeg",className:"w-full file-input cursor-pointer"}),h&&e.jsx("div",{className:"mt-4",children:e.jsx("img",{src:h,alt:"Previsualización",className:"max-w-xs h-auto rounded-md shadow-md"})})]})]}),e.jsxs("div",{className:"md:col-span-2 flex justify-end gap-4 mt-4",children:[e.jsx(N,{type:"button",className:"cursor-pointer",onClick:()=>i("/events"),disabled:m,children:"Cancelar"}),e.jsx(N,{type:"submit",className:"cursor-pointer",disabled:m,children:m?e.jsx(S,{}):"Crear Congreso"})]})]})})]})}):e.jsxs("div",{className:"pt-20 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4 text-red-500",children:"Acceso Denegado"}),e.jsx("p",{className:"text-lg",children:"No tienes permiso para esta acción."})]})},$=`
  .input-class {
    background-color: #2d3748; /* bg-input-bg */
    border: 1px solid #4a5568; /* border-input-border */
    color: #f7fafc; /* text-text-primary */
    padding: 0.5rem 0.75rem;
    border-radius: 0.375rem;
  }
  .file-input {
    border-radius: 9999px;
    border-width: 0px;
    font-size: 0.875rem;
    font-weight: 600;
    background-color: #4299e1; /* bg-accent-primary */
    color: white;
  }
  .file-input:hover {
    background-color: #2b6cb0;
  }
`,b=document.createElement("style");b.type="text/css";b.innerText=$;document.head.appendChild(b);export{K as default};
