import{r as a,a as N,y as r,j as e,L as w,M as v,N as C,D as P,C as V}from"./index-CDtZe3id.js";import{c as p}from"./courseService-BSeO5xSq.js";const E=({course:t,onPublish:l,onGuestViewable:n})=>e.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[e.jsx("button",{onClick:()=>l(t._id,t),className:`text-2xl ${t.isPublished?"text-green-500 hover:text-green-700":"text-gray-400 hover:text-gray-600"}`,title:t.isPublished?"Despublicar Curso":"Publicar Curso",children:t.isPublished?e.jsx(v,{}):e.jsx(C,{})}),e.jsx("button",{onClick:()=>n(t._id,t.isGuestViewable),className:`text-2xl ${t.isGuestViewable?"text-blue-500 hover:text-blue-700":"text-gray-400 hover:text-gray-600"}`,title:t.isGuestViewable?"Ocultar para Invitados":"Hacer Visible para Invitados",children:t.isGuestViewable?e.jsx(P,{}):e.jsx(V,{})})]}),S=()=>{const[t,l]=a.useState([]),[n,h]=a.useState(!0),[u,m]=a.useState(null),{hasRole:g}=N(),c=g(["admin"]),i=a.useCallback(async()=>{try{h(!0);const s=await p.getCourses();l(s),m(null)}catch(s){console.error("Error fetching courses:",s),m("No se pudieron cargar los cursos."),r.error("Error al cargar los cursos.")}finally{h(!1)}},[]);a.useEffect(()=>{c&&i()},[c,i]);const f=async(s,d)=>{try{await p.updateCourse(s,{isGuestViewable:!d}),r.success("Visibilidad para invitados actualizada."),i()}catch(x){r.error(x.response?.data?.message||"Error al cambiar la visibilidad.")}},j=async(s,d)=>{const{isPublished:x}=d,o=!x;let b={isPublished:o};o||(b.isGuestViewable=!1);try{await p.updateCourse(s,b),r.success(`Curso ${o?"publicado":"despublicado"}.`),i()}catch(y){r.error(y.response?.data?.message||"Error al cambiar el estado de publicación.")}};return n&&!t.length?e.jsxs("div",{className:"pt-20 flex flex-col items-center justify-center min-h-[calc(100vh-80px)]",children:[e.jsx(w,{}),e.jsx("p",{className:"mt-4",children:"Cargando cursos..."})]}):u?e.jsxs("div",{className:"pt-20 p-8 text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4 text-red-500",children:"Error"}),e.jsx("p",{className:"text-lg",children:u})]}):c?e.jsx("div",{className:"mt-28 p-8 min-h-screen bg-bg-primary text-text-primary",children:e.jsxs("div",{className:"max-w-[1024px] mx-auto",children:[e.jsx("div",{className:"flex justify-between items-center mb-8",children:e.jsx("h1",{className:"text-3xl font-bold text-center w-full",children:"Gestión de Publicación de Cursos"})}),t.length===0?e.jsx("div",{className:"text-center text-text-secondary py-10",children:e.jsx("p",{children:"No hay cursos disponibles para gestionar."})}):e.jsx("div",{className:"bg-bg-secondary p-6 rounded-lg shadow-md border border-border-color",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-border-color",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Título"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Autor"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Publicado"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Visible p/ Invitados"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Acciones"})]})}),e.jsx("tbody",{className:"bg-bg-secondary divide-y divide-border-color",children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-text-primary font-medium",children:s.title}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-text-secondary",children:s.author?`${s.author.name} ${s.author.last_name}`:"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${s.isPublished?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.isPublished?"Sí":"No"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${s.isGuestViewable?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.isGuestViewable?"Sí":"No"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsx(E,{course:s,onPublish:j,onGuestViewable:f})})]},s._id))})]})})})]})}):e.jsxs("div",{className:"pt-20 p-8 text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4 text-red-500",children:"Acceso Denegado"}),e.jsx("p",{className:"text-lg",children:"No tienes permiso para ver esta página."})]})};export{S as default};
