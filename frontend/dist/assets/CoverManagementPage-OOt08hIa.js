import{r as s,a as S,j as e,L as k,K as I,y as A}from"./index-CDtZe3id.js";import{c as f}from"./coverService-mfvIq_ty.js";import{C as b}from"./CustomButton-BHk0TsfB.js";import{S as p}from"./sweetalert2.esm.all-CH_YVA8w.js";const F=()=>{const[a,v]=s.useState([]),[y,n]=s.useState(!0),[g,l]=s.useState(null),{hasRole:N}=S(),[o,d]=s.useState(1),[c,w]=s.useState(5),m=N(["admin"]),u=async()=>{try{n(!0);const r=(await f.getCovers()).sort((i,E)=>i.name.localeCompare(E.name));v(r),l(null)}catch(t){console.error("Error fetching covers:",t),l("No se pudieron cargar las portadas. Por favor, inténtalo de nuevo más tarde."),A.error("Error al cargar las portadas.")}finally{n(!1)}};s.useEffect(()=>{m?u():(n(!1),l("No tienes permiso para ver esta página."))},[m]);const C=t=>{p.fire({title:"¿Estás seguro?",text:"No podrás revertir esta acción.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, ¡eliminar!",cancelButtonText:"Cancelar"}).then(async r=>{if(r.isConfirmed)try{n(!0),await f.deleteCover(t),p.fire("¡Eliminada!","La portada ha sido eliminada.","success"),u()}catch(i){console.error("Error deleting cover:",i),p.fire("Error",i.response?.data?.message||"Error al eliminar la portada.","error")}finally{n(!1)}})},x=o*c,j=x-c,P=a.slice(j,x),h=Math.ceil(a.length/c);return y?e.jsxs("div",{className:"mt-28 flex flex-col items-center justify-center min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:[e.jsx(k,{}),e.jsx("p",{className:"mt-4",children:"Cargando portadas..."})]}):g?e.jsxs("div",{className:"mt-28 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4 text-red-500",children:"Error"}),e.jsx("p",{className:"text-lg",children:g})]}):m?e.jsx("div",{className:"mt-28 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:e.jsxs("div",{className:"max-w-[1024px] mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold text-center w-full mb-8",children:"Gestión de Portadas"}),a.length===0?e.jsx("div",{className:"text-center text-text-secondary",children:e.jsx("p",{children:"No hay portadas disponibles en este momento."})}):e.jsxs("div",{className:"bg-bg-secondary p-6 rounded-lg shadow-md border border-border-color",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Listado de Portadas"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("label",{htmlFor:"itemsPerPage",className:"mr-2",children:"Items por página:"}),e.jsxs("select",{id:"itemsPerPage",value:c,onChange:t=>{w(Number(t.target.value)),d(1)},className:"bg-bg-secondary border border-border-color rounded-md p-1",children:[e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:15,children:"15"}),e.jsx("option",{value:20,children:"20"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-border-color",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Nombre"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Imagen"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Acciones"})]})}),e.jsx("tbody",{className:"bg-bg-secondary divide-y divide-border-color",children:P.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-text-secondary",children:t.name||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("img",{src:`https://portal-educativo-jab.onrender.com/api/covers/${t._id}`,alt:t.name||"Portada",className:"h-16 w-16 object-cover rounded-md",onError:r=>{r.target.onerror=null,r.target.src="https://placehold.co/64x64/cccccc/333333?text=No+Image"}})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsx("button",{onClick:()=>C(t._id),className:"text-gray-400 hover:text-red-600 cursor-pointer",title:"Eliminar",children:e.jsx(I,{})})})]},t._id))})]})}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-text-secondary",children:["Mostrando ",j+1," a ",Math.min(x,a.length)," de ",a.length," portadas"]})}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(b,{onClick:()=>d(t=>Math.max(t-1,1)),disabled:o===1,variant:"secondary",children:"Anterior"}),e.jsxs("span",{className:"mx-4",children:["Página ",o," de ",h]}),e.jsx(b,{onClick:()=>d(t=>Math.min(t+1,h)),disabled:o===h,variant:"secondary",children:"Siguiente"})]})]})]})]})}):e.jsxs("div",{className:"mt-28 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4 text-red-500",children:"Acceso Denegado"}),e.jsx("p",{className:"text-lg",children:"No tienes permiso para ver esta página."})]})};export{F as default};
