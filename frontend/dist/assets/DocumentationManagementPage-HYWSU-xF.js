import{u as w,r as l,j as e,L as N,O as v,P as C,D as x,C as k,J as E,K as B,y as a}from"./index-CDtZe3id.js";import{d as r}from"./documentationService-D56WLKkg.js";import{C as P}from"./CustomButton-BHk0TsfB.js";import{S as u}from"./sweetalert2.esm.all-CH_YVA8w.js";const T=()=>{const o=w(),[m,h]=l.useState([]),[p,c]=l.useState(!0),n=async()=>{try{c(!0);const t=await r.getAll();h(t)}catch(t){a.error("Error al cargar la documentación."),console.error("Error fetching documentation:",t)}finally{c(!1)}};l.useEffect(()=>{n()},[]);const b=async t=>{try{const s=await r.getFileContent(t),i=URL.createObjectURL(s);window.open(i,"_blank")}catch(s){a.error("Error al visualizar el documento."),console.error("Error fetching document content:",s)}},y=async t=>{u.fire({title:"¿Estás seguro?",text:"¡No podrás revertir esta acción!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Sí, ¡eliminar!",cancelButtonText:"Cancelar"}).then(async s=>{if(s.isConfirmed)try{await r.remove(t),a.success("Documento eliminado exitosamente."),n()}catch(i){a.error(i.response?.data?.message||"Error al eliminar el documento.")}})},d=async t=>{const s=t.isPublished?"despublicar":"publicar",i=t.isPublished?"despublicado":"publicado";u.fire({title:`¿Estás seguro de que quieres ${s} este documento?`,icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:`Sí, ¡${s}!`,cancelButtonText:"Cancelar"}).then(async f=>{if(f.isConfirmed)try{t.isPublished?await r.unpublish(t._id):await r.publish(t._id),a.success(`Documento ${i} exitosamente.`),n()}catch(j){a.error(j.response?.data?.message||`Error al ${s} el documento.`)}})},g=async t=>{try{await r.toggleGuestViewable(t._id),a.success("Visibilidad para invitados actualizada."),n()}catch(s){a.error(s.response?.data?.message||"Error al actualizar la visibilidad.")}};return p?e.jsx("div",{className:"pt-20 flex justify-center",children:e.jsx(N,{})}):e.jsx("div",{className:"mt-28 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:e.jsxs("div",{className:"max-w-[1024px] mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Gestión de Documentación"}),e.jsx(P,{onClick:()=>o("/documentation/create"),children:"Añadir Documento"})]}),e.jsx("div",{className:"bg-bg-secondary p-6 rounded-lg shadow-md border border-border-color overflow-x-auto",children:e.jsxs("table",{className:"w-full table-auto divide-y divide-border-color",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Título"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Autor"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Asignatura"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Estado"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Visible Invitados"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-text-secondary uppercase tracking-wider min-w-54",children:"Acciones"})]})}),e.jsx("tbody",{className:"bg-bg-secondary divide-y divide-border-color",children:m.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 text-text-primary break-words font-semibold",children:t.title}),e.jsx("td",{className:"px-6 py-4 text-text-secondary break-words",children:t.uploadedBy?.name||"N/A"}),e.jsx("td",{className:"px-6 py-4 text-text-secondary break-words",children:t.asignatura?.name||"N/A"}),e.jsx("td",{className:"px-6 py-4 text-text-primary",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${t.isPublished?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:t.isPublished?"Publicado":"Pendiente"})}),e.jsx("td",{className:"px-6 py-4 text-text-primary",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${t.isGuestViewable?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:t.isGuestViewable?"Sí":"No"})}),e.jsxs("td",{className:"px-6 py-4 text-right text-sm font-medium",children:[t.isPublished?e.jsx("button",{onClick:()=>d(t),className:"text-yellow-600 hover:text-yellow-900 mr-4",title:"Despublicar",children:e.jsx(v,{size:18})}):e.jsx("button",{onClick:()=>d(t),className:"text-green-600 hover:text-green-900 mr-4",title:"Publicar",children:e.jsx(C,{size:18})}),e.jsx("button",{onClick:()=>g(t),className:`mr-4 ${t.isGuestViewable?"text-blue-600 hover:text-blue-900":"text-gray-400 hover:text-gray-600"}`,title:"Visible para Invitados",children:t.isGuestViewable?e.jsx(x,{size:18}):e.jsx(k,{size:18})}),e.jsx("button",{onClick:()=>b(t._id),className:"text-blue-600 hover:text-blue-900 mr-4",title:"Visualizar",children:e.jsx(x,{size:18})}),e.jsx("button",{onClick:()=>o(`/documentation/edit/${t._id}`),className:"text-accent-primary hover:text-blue-700 mr-4",title:"Editar",children:e.jsx(E,{size:18})}),e.jsx("button",{onClick:()=>y(t._id),className:"text-red-600 hover:text-red-900",title:"Eliminar",children:e.jsx(B,{size:18})})]})]},t._id))})]})})]})})};export{T as default};
