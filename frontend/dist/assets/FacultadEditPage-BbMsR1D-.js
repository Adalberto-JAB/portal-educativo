import{b as v,u as E,a as F,r as o,j as e,L as f,y as l}from"./index-CDtZe3id.js";import{f as b}from"./facultadService-BYypkmnv.js";import{C as h}from"./CustomButton-BHk0TsfB.js";import{u as w}from"./index.esm-CYe7NKTW.js";import{o as S,c as C,a as g}from"./index.esm-DVNFl3iM.js";const k=C().shape({name:g().required("El nombre de la facultad es requerido"),description:g().nullable()}),D=()=>{const{id:c}=v(),n=E(),{hasRole:j}=F(),[t,r]=o.useState(!0),[m,i]=o.useState(null),{register:x,handleSubmit:y,formState:{errors:u},setValue:d}=w({resolver:S(k)}),s=j(["admin"]);o.useEffect(()=>{(async()=>{if(!s){r(!1),i("No tienes permiso para editar facultades.");return}try{r(!0);const a=await b.getFacultadById(c);d("name",a.name),d("description",a.description||""),i(null)}catch(a){console.error("Error fetching facultad for edit:",a),i("No se pudo cargar la facultad para edición."),l.error("Error al cargar la facultad.")}finally{r(!1)}})()},[c,s,d]);const N=async p=>{if(!s){l.error("No tienes permiso para modificar facultades.");return}try{r(!0),await b.updateFacultad(c,p),l.success("Facultad actualizada exitosamente."),n("/admin/facultades")}catch(a){console.error("Error updating facultad:",a),l.error(a.response?.data?.message||"Error al actualizar la facultad.")}finally{r(!1)}};return t?e.jsxs("div",{className:"mt-28 flex flex-col items-center justify-center min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:[e.jsx(f,{}),e.jsx("p",{className:"mt-4",children:"Cargando facultad para edición..."})]}):m?e.jsxs("div",{className:"mt-28 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4 text-red-500",children:"Error"}),e.jsx("p",{className:"text-lg",children:m})]}):s?e.jsx("div",{className:"mt-28 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:e.jsxs("div",{className:"max-w-[1024px] mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 text-center w-full",children:"Editar Facultad"}),e.jsx("div",{className:"bg-bg-secondary p-8 rounded-lg shadow-lg w-full max-w-md mx-auto border border-border-color",children:e.jsxs("form",{onSubmit:y(N),className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-text-primary text-sm font-bold mb-2",htmlFor:"name",children:"Nombre de la Facultad:"}),e.jsx("input",{type:"text",id:"name",...x("name"),className:"w-full px-3 py-2 border rounded-md bg-input-bg text-text-primary border-input-border"}),u.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:u.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-text-primary text-sm font-bold mb-2",htmlFor:"description",children:"Descripción (opcional):"}),e.jsx("textarea",{id:"description",...x("description"),className:"w-full px-3 py-2 border rounded-md bg-input-bg text-text-primary border-input-border",rows:"3"})]}),e.jsxs("div",{className:"flex justify-end gap-4 mt-4",children:[e.jsx(h,{variant:"secondary",className:"cursor-pointer",onClick:()=>n("/admin/facultades"),disabled:t,children:"Cancelar"}),e.jsx(h,{variant:"primary",className:"cursor-pointer",type:"submit",disabled:t,children:t?e.jsx(f,{}):"Guardar Cambios"})]})]})})]})}):e.jsxs("div",{className:"mt-28 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4 text-red-500",children:"Acceso Denegado"}),e.jsx("p",{className:"text-lg",children:"No tienes permiso para editar facultades."})]})};export{D as default};
