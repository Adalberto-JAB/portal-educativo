import{u as F,r as a,a as S,j as e,L as A,Q as B,J as L,K as M,y as I}from"./index-CDtZe3id.js";import{f as N}from"./facultadService-BYypkmnv.js";import{C as u}from"./CustomButton-BHk0TsfB.js";import{S as p}from"./sweetalert2.esm.all-CH_YVA8w.js";const R=()=>{const f=F(),[s,y]=a.useState([]),[v,r]=a.useState(!0),[g,n]=a.useState(null),{hasRole:w}=S(),[c,d]=a.useState(1),[l,C]=a.useState(10),o=w(["admin"]),j=async()=>{try{r(!0);const h=(await N.getFacultades()).sort((i,E)=>i.name.localeCompare(E.name));y(h),n(null)}catch(t){console.error("Error fetching facultades:",t),n("No se pudieron cargar las facultades. Por favor, inténtalo de nuevo más tarde."),I.error("Error al cargar las facultades.")}finally{r(!1)}};a.useEffect(()=>{o?j():(r(!1),n("No tienes permiso para ver esta página."))},[o]);const P=t=>{p.fire({title:"¿Estás seguro?",text:"No podrás revertir esta acción.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, ¡eliminar!",cancelButtonText:"Cancelar"}).then(async h=>{if(h.isConfirmed)try{r(!0),await N.deleteFacultad(t),p.fire("¡Eliminada!","La facultad ha sido eliminada.","success"),j()}catch(i){console.error("Error deleting facultad:",i),p.fire("Error",i.response?.data?.message||"Error al eliminar la facultad.","error")}finally{r(!1)}})},m=c*l,b=m-l,k=s.slice(b,m),x=Math.ceil(s.length/l);return v?e.jsxs("div",{className:"mt-28 flex flex-col items-center justify-center min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:[e.jsx(A,{}),e.jsx("p",{className:"mt-4",children:"Cargando facultades..."})]}):g?e.jsxs("div",{className:"mt-28 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4 text-red-500",children:"Error"}),e.jsx("p",{className:"text-lg",children:g})]}):o?e.jsx("div",{className:"mt-28 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:e.jsxs("div",{className:"max-w-[1024px] mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold text-center w-full mb-4",children:"Gestión de Facultades"}),e.jsx("div",{className:"flex justify-end-safe mb-8",children:e.jsxs(u,{variant:"primary",onClick:()=>f("/admin/facultades/create"),children:[e.jsx(B,{className:"inline-block mr-2"})," Crear Nueva Facultad"]})}),s.length===0?e.jsx("div",{className:"text-center text-text-secondary",children:e.jsx("p",{children:"No hay facultades disponibles en este momento."})}):e.jsxs("div",{className:"bg-bg-secondary p-6 rounded-lg shadow-md border border-border-color",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Listado de Facultades"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("label",{htmlFor:"itemsPerPage",className:"mr-2",children:"Items por página:"}),e.jsxs("select",{id:"itemsPerPage",value:l,onChange:t=>{C(Number(t.target.value)),d(1)},className:"bg-bg-secondary border border-border-color rounded-md p-1",children:[e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:50,children:"50"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-border-color",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Nombre"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Descripción"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Acciones"})]})}),e.jsx("tbody",{className:"bg-bg-secondary divide-y divide-border-color",children:k.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 text-text-primary max-w-40 break-words",children:t.name}),e.jsx("td",{className:"px-6 py-4 text-text-secondary max-w-2xl break-words",children:t.description||"N/A"}),e.jsxs("td",{className:"px-6 py-4 text-right text-sm font-medium max-w-16",children:[e.jsx("a",{onClick:()=>f(`/admin/facultades/edit/${t._id}`),className:"text-accent-primary hover:text-blue-700 mr-3 cursor-pointer",children:e.jsx(L,{className:"inline-block mr-1"})}),e.jsx("button",{onClick:()=>P(t._id),className:"text-red-600 hover:text-red-900",children:e.jsx(M,{className:"inline-block mr-1"})})]})]},t._id))})]})}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-text-secondary",children:["Mostrando ",b+1," a ",Math.min(m,s.length)," de ",s.length," facultades"]})}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(u,{onClick:()=>d(t=>Math.max(t-1,1)),disabled:c===1,variant:"secondary",children:"Anterior"}),e.jsxs("span",{className:"mx-4",children:["Página ",c," de ",x]}),e.jsx(u,{onClick:()=>d(t=>Math.min(t+1,x)),disabled:c===x,variant:"secondary",children:"Siguiente"})]})]})]})]})}):e.jsxs("div",{className:"mt-28 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4 text-red-500",children:"Acceso Denegado"}),e.jsx("p",{className:"text-lg",children:"No tienes permiso para ver esta página."})]})};export{R as default};
