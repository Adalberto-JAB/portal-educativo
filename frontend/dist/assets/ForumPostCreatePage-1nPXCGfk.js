import{u as h,a as g,r as i,j as e,L as u,y as o}from"./index-CDtZe3id.js";import{u as v}from"./index.esm-CYe7NKTW.js";import{o as y,c as N,a as l}from"./index.esm-DVNFl3iM.js";import{f as S}from"./forumService-DfOgb0S1.js";import{s as E}from"./subjectService-FmAgODbn.js";import{C as b}from"./CustomButton-BHk0TsfB.js";const w=N().shape({title:l().required("El título es requerido").min(5,"El título debe tener al menos 5 caracteres"),content:l().required("El contenido es requerido").min(10,"El contenido debe tener al menos 10 caracteres"),subject:l().required("Debes seleccionar una materia")}),L=()=>{const d=h(),{user:m}=g(),[x,p]=i.useState([]),[a,c]=i.useState(!0),{register:n,handleSubmit:j,formState:{errors:r}}=v({resolver:y(w)});i.useEffect(()=>{(async()=>{try{const t=await E.getSubjects();p(t)}catch(t){o.error("Error al cargar las materias."),console.error("Error fetching subjects:",t)}finally{c(!1)}})()},[]);const f=async s=>{if(!m){o.error("Debes iniciar sesión para crear un post.");return}c(!0);try{const t={...s,author:m.id};await S.createForumPost(t),o.success("¡Post creado! Estará visible una vez que sea aprobado por un administrador."),d("/forums")}catch(t){o.error(t.response?.data?.message||"Error al crear el post."),console.error("Error creating forum post:",t)}finally{c(!1)}};return a?e.jsx("div",{className:"pt-20 flex justify-center items-center min-h-screen",children:e.jsx(u,{})}):e.jsx("div",{className:"pt-20 p-8 min-h-screen bg-bg-primary text-text-primary",children:e.jsxs("div",{className:"max-w-3xl mx-auto bg-bg-secondary p-8 rounded-lg shadow-lg border border-border-color",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Crear Nuevo Post en el Foro"}),e.jsxs("form",{onSubmit:j(f),className:"flex flex-col gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"subject",className:"block text-sm font-bold mb-2",children:"Materia"}),e.jsxs("select",{id:"subject",...n("subject"),className:"w-full p-3 border rounded-md bg-input-bg text-text-primary border-input-border",children:[e.jsx("option",{value:"",children:"-- Selecciona una materia --"}),x.map(s=>e.jsx("option",{value:s._id,children:s.name},s._id))]}),r.subject&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.subject.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-bold mb-2",children:"Título del Post"}),e.jsx("input",{type:"text",id:"title",...n("title"),className:"w-full p-3 border rounded-md bg-input-bg text-text-primary border-input-border"}),r.title&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.title.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"content",className:"block text-sm font-bold mb-2",children:"Contenido"}),e.jsx("textarea",{id:"content",...n("content"),rows:"8",className:"w-full p-3 border rounded-md bg-input-bg text-text-primary border-input-border"}),r.content&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.content.message})]}),e.jsxs("div",{className:"flex justify-end gap-4 mt-4",children:[e.jsx(b,{type:"button",onClick:()=>d("/forums"),disabled:a,children:"Cancelar"}),e.jsx(b,{type:"submit",disabled:a,children:a?e.jsx(u,{}):"Crear Post"})]})]})]})})};export{L as default};
