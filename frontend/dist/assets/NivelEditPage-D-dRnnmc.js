import{b as y,u as E,a as w,r as c,j as e,L as b,y as i}from"./index-CDtZe3id.js";import{n as h}from"./nivelService-D0XCMSzS.js";import{C as v}from"./CustomButton-BHk0TsfB.js";import{u as S}from"./index.esm-CYe7NKTW.js";import{o as C,c as k,a as f}from"./index.esm-DVNFl3iM.js";const A=k().shape({name:f().required("El nombre del nivel es requerido"),description:f().nullable()}),D=()=>{const{id:l}=y(),m=E(),{hasRole:g}=w(),[a,t]=c.useState(!0),[d,n]=c.useState(null),{register:x,handleSubmit:N,formState:{errors:p},setValue:o}=S({resolver:C(A)}),s=g(["admin"]);c.useEffect(()=>{(async()=>{if(!s){t(!1),n("No tienes permiso para editar niveles.");return}try{t(!0);const r=await h.getNivelById(l);o("name",r.name),o("description",r.description||""),n(null)}catch(r){console.error("Error fetching nivel for edit:",r),n("No se pudo cargar el nivel para edición."),i.error("Error al cargar el nivel.")}finally{t(!1)}})()},[l,s,o]);const j=async u=>{if(!s){i.error("No tienes permiso para modificar niveles.");return}try{t(!0),await h.updateNivel(l,u),i.success("Nivel actualizado exitosamente."),m("/admin/niveles")}catch(r){console.error("Error updating nivel:",r),i.error(r.response?.data?.message||"Error al actualizar el nivel.")}finally{t(!1)}};return a?e.jsxs("div",{className:"mt-28 flex flex-col items-center justify-center min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:[e.jsx(b,{}),e.jsx("p",{className:"mt-4",children:"Cargando nivel para edición..."})]}):d?e.jsxs("div",{className:"mt-28 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4 text-red-500",children:"Error"}),e.jsx("p",{className:"text-lg",children:d})]}):s?e.jsx("div",{className:"mt-28 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:e.jsxs("div",{className:"max-w-[1024px] mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 text-center w-full",children:"Editar Nivel"}),e.jsx("div",{className:"bg-bg-secondary p-8 rounded-lg shadow-lg w-full max-w-md mx-auto border border-border-color",children:e.jsxs("form",{onSubmit:N(j),className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-text-primary text-sm font-bold mb-2",htmlFor:"name",children:"Nombre del Nivel:"}),e.jsx("input",{type:"text",id:"name",...x("name"),className:"w-full px-3 py-2 border rounded-md bg-input-bg text-text-primary border-input-border"}),p.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:p.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-text-primary text-sm font-bold mb-2",htmlFor:"description",children:"Descripción (opcional):"}),e.jsx("textarea",{id:"description",...x("description"),className:"w-full px-3 py-2 border rounded-md bg-input-bg text-text-primary border-input-border",rows:"3"})]}),e.jsxs("div",{className:"flex justify-end gap-4 mt-4",children:[e.jsx(v,{variant:"secondary",className:"cursor-pointer",onClick:()=>m("/admin/niveles"),disabled:a,children:"Cancelar"}),e.jsx(v,{variant:"primary",className:"cursor-pointer",type:"submit",disabled:a,children:a?e.jsx(b,{}):"Guardar Cambios"})]})]})})]})}):e.jsxs("div",{className:"mt-28 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4 text-red-500",children:"Acceso Denegado"}),e.jsx("p",{className:"text-lg",children:"No tienes permiso para editar niveles."})]})};export{D as default};
