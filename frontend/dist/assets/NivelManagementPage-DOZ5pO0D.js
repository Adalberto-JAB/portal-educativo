import{u as g,r as s,a as N,j as e,L as y,J as b,K as j,y as w}from"./index-CDtZe3id.js";import{n as m}from"./nivelService-D0XCMSzS.js";import{C as E}from"./CustomButton-BHk0TsfB.js";import{S as l}from"./sweetalert2.esm.all-CH_YVA8w.js";const A=()=>{const n=g(),[c,p]=s.useState([]),[h,r]=s.useState(!0),[o,a]=s.useState(null),{hasRole:u}=N(),i=u(["admin"]),d=async()=>{try{r(!0);const t=await m.getNiveles();p(t),a(null)}catch(t){console.error("Error fetching niveles:",t),a("No se pudieron cargar los niveles. Por favor, inténtalo de nuevo más tarde."),w.error("Error al cargar los niveles.")}finally{r(!1)}};s.useEffect(()=>{i?d():(r(!1),a("No tienes permiso para ver esta página."))},[i]);const f=t=>{l.fire({title:"¿Estás seguro?",text:"No podrás revertir esta acción.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, ¡eliminar!",cancelButtonText:"Cancelar"}).then(async v=>{if(v.isConfirmed)try{r(!0),await m.deleteNivel(t),l.fire("¡Eliminado!","El nivel ha sido eliminado.","success"),d()}catch(x){console.error("Error deleting nivel:",x),l.fire("Error",x.response?.data?.message||"Error al eliminar el nivel.","error")}finally{r(!1)}})};return h?e.jsxs("div",{className:"mt-28 flex flex-col items-center justify-center min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:[e.jsx(y,{}),e.jsx("p",{className:"mt-4",children:"Cargando niveles..."})]}):o?e.jsxs("div",{className:"mt-28 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4 text-red-500",children:"Error"}),e.jsx("p",{className:"text-lg",children:o})]}):i?e.jsx("div",{className:"pt-20 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:e.jsxs("div",{className:"max-w-[1024px] mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold text-center w-full mb-4",children:"Gestión de Niveles"}),e.jsx("div",{className:"flex justify-end-safe mb-8",children:e.jsx(E,{variant:"primary",onClick:()=>n("/admin/niveles/create"),children:"Crear Nuevo Nivel"})}),c.length===0?e.jsx("div",{className:"text-center text-text-secondary",children:e.jsx("p",{children:"No hay niveles disponibles en este momento."})}):e.jsxs("div",{className:"bg-bg-secondary p-6 rounded-lg shadow-md border border-border-color overflow-x-auto",children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-4",children:"Listado de Niveles"}),e.jsxs("table",{className:"w-full table-auto divide-y divide-border-color",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"w-1/3 px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Nombre"}),e.jsx("th",{scope:"col",className:"w-2/3 px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Descripción"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Acciones"})]})}),e.jsx("tbody",{className:"bg-bg-secondary divide-y divide-border-color",children:c.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 text-text-primary break-words",children:t.name}),e.jsx("td",{className:"px-6 py-4 text-text-secondary break-words",children:t.description||"N/A"}),e.jsxs("td",{className:"px-6 py-4 text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>n(`/admin/niveles/edit/${t._id}`),className:"text-accent-primary hover:text-blue-700 mr-4",title:"Editar",children:e.jsx(b,{size:18})}),e.jsx("button",{onClick:()=>f(t._id),className:"text-red-600 hover:text-red-900",title:"Eliminar",children:e.jsx(j,{size:18})})]})]},t._id))})]})]})]})}):e.jsxs("div",{className:"mt-28 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4 text-red-500",children:"Acceso Denegado"}),e.jsx("p",{className:"text-lg",children:"No tienes permiso para ver esta página."})]})};export{A as default};
