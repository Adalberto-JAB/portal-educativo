import{b as v,u as E,a as w,r as x,j as e,L as h,y as m}from"./index-CDtZe3id.js";import{u as f}from"./userService-BeE_nVnS.js";import{C as j}from"./CustomButton-BHk0TsfB.js";import{u as q}from"./index.esm-CYe7NKTW.js";import{o as S,c as _,a as l}from"./index.esm-DVNFl3iM.js";const k=_().shape({name:l().required("El nombre es requerido"),last_name:l().required("El apellido es requerido"),email:l().email("Debe ser un email válido").required("El email es requerido"),role:l().required("El rol es requerido"),address:l().nullable(),phoneNumber:l().nullable()}),L=()=>{const{id:n}=v(),u=E(),{hasRole:g}=w(),[o,i]=x.useState(!0),[p,c]=x.useState(null),{register:a,handleSubmit:y,formState:{errors:t},setValue:s}=q({resolver:S(k)}),d=g(["admin"]);x.useEffect(()=>{(async()=>{if(!d){i(!1),c("No tienes permiso para editar usuarios.");return}try{i(!0);const r=await f.getUserById(n);s("name",r.name||""),s("last_name",r.last_name||""),s("email",r.email||""),s("role",r.role||""),s("address",r.address||""),s("phoneNumber",r.phoneNumber||""),c(null)}catch(r){console.error("Error fetching user for edit:",r),c("No se pudo cargar el usuario para edición."),m.error("Error al cargar el usuario.")}finally{i(!1)}})()},[n,d,s]);const N=async b=>{if(!d){m.error("No tienes permiso para modificar usuarios.");return}try{i(!0),await f.updateUser(n,b),m.success("Usuario actualizado exitosamente."),u("/admin/users")}catch(r){console.error("Error updating user:",r),m.error(r.response?.data?.message||"Error al actualizar el usuario.")}finally{i(!1)}};return o?e.jsxs("div",{className:"pt-20 flex flex-col items-center justify-center min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:[e.jsx(h,{}),e.jsx("p",{className:"mt-4",children:"Cargando usuario para edición..."})]}):p?e.jsxs("div",{className:"pt-20 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4 text-red-500",children:"Error"}),e.jsx("p",{className:"text-lg",children:p})]}):d?e.jsx("div",{className:"mt-28 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:e.jsxs("div",{className:"max-w-[1024px] mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 text-center",children:"Editar Usuario"}),e.jsx("div",{className:"bg-bg-secondary p-8 rounded-lg shadow-lg w-full max-w-md mx-auto border border-border-color",children:e.jsxs("form",{onSubmit:y(N),className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-text-primary text-sm font-bold mb-2",htmlFor:"name",children:"Nombre:"}),e.jsx("input",{type:"text",id:"name",...a("name"),className:"w-full px-3 py-2 border rounded-md bg-input-bg text-text-primary border-input-border"}),t.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-text-primary text-sm font-bold mb-2",htmlFor:"last_name",children:"Apellido:"}),e.jsx("input",{type:"text",id:"last_name",...a("last_name"),className:"w-full px-3 py-2 border rounded-md bg-input-bg text-text-primary border-input-border"}),t.last_name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.last_name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-text-primary text-sm font-bold mb-2",htmlFor:"email",children:"Email:"}),e.jsx("input",{type:"email",id:"email",...a("email"),className:"w-full px-3 py-2 border rounded-md bg-input-bg text-text-primary border-input-border"}),t.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.email.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-text-primary text-sm font-bold mb-2",htmlFor:"role",children:"Rol:"}),e.jsxs("select",{id:"role",...a("role"),className:"w-full px-3 py-2 border rounded-md bg-input-bg text-text-primary border-input-border",children:[e.jsx("option",{value:"student",children:"Estudiante"}),e.jsx("option",{value:"teacher",children:"Profesor"}),e.jsx("option",{value:"admin",children:"Administrador"})]}),t.role&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.role.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-text-primary text-sm font-bold mb-2",htmlFor:"address",children:"Dirección:"}),e.jsx("input",{type:"text",id:"address",...a("address"),className:"w-full px-3 py-2 border rounded-md bg-input-bg text-text-primary border-input-border"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-text-primary text-sm font-bold mb-2",htmlFor:"phoneNumber",children:"Teléfono:"}),e.jsx("input",{type:"text",id:"phoneNumber",...a("phoneNumber"),className:"w-full px-3 py-2 border rounded-md bg-input-bg text-text-primary border-input-border"})]}),e.jsxs("div",{className:"flex justify-end gap-4 mt-4",children:[e.jsx(j,{variant:"secondary",className:"cursor-pointer",onClick:()=>u("/admin/users"),disabled:o,children:"Cancelar"}),e.jsx(j,{variant:"primary",className:"cursor-pointer",type:"submit",disabled:o,children:o?e.jsx(h,{}):"Guardar Cambios"})]})]})})]})}):e.jsxs("div",{className:"pt-20 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4 text-red-500",children:"Acceso Denegado"}),e.jsx("p",{className:"text-lg",children:"No tienes permiso para editar usuarios."})]})};export{L as default};
