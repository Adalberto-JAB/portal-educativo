import{u as f,r,a as y,j as e,L as j,J as N,K as b,y as c}from"./index-CDtZe3id.js";import{u as x}from"./userService-BeE_nVnS.js";import{S as v}from"./sweetalert2.esm.all-CH_YVA8w.js";const k=()=>{const m=f(),[o,p]=r.useState([]),[h,s]=r.useState(!0),[n,a]=r.useState(null),{hasRole:u}=y(),i=u(["admin"]),l=async()=>{try{s(!0);const t=await x.getUsers();p(t),a(null)}catch(t){console.error("Error fetching users:",t),a("No se pudieron cargar los usuarios. Por favor, inténtalo de nuevo más tarde."),c.error("Error al cargar los usuarios.")}finally{s(!1)}};r.useEffect(()=>{i?l():(s(!1),a("No tienes permiso para ver esta página."))},[i]);const g=async t=>{if((await v.fire({title:"¿Estás seguro?",text:"¡No podrás revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, ¡elimínalo!",cancelButtonText:"Cancelar"})).isConfirmed)try{s(!0),await x.deleteUser(t),c.success("Usuario eliminado exitosamente."),l()}catch(d){console.error("Error deleting user:",d),c.error(d.response?.data?.message||"Error al eliminar el usuario."),s(!1)}};return h?e.jsxs("div",{className:"mt-28 flex flex-col items-center justify-center min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:[e.jsx(j,{}),e.jsx("p",{className:"mt-4",children:"Cargando usuarios..."})]}):n?e.jsxs("div",{className:"mt-28 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4 text-red-500",children:"Error"}),e.jsx("p",{className:"text-lg",children:n})]}):i?e.jsx("div",{className:"mt-28 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary",children:e.jsxs("div",{className:"max-w-[1024px] mx-auto",children:[e.jsx("div",{className:"flex justify-between items-center mb-8",children:e.jsx("h1",{className:"text-3xl font-bold text-center w-full",children:"Gestión de Usuarios"})}),o.length===0?e.jsx("div",{className:"text-center text-text-secondary",children:e.jsx("p",{children:"No hay usuarios registrados en este momento."})}):e.jsxs("div",{className:"bg-bg-secondary p-6 rounded-lg shadow-md border border-border-color",children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-4",children:"Listado de Usuarios"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-border-color",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Nombre"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Email"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Rol"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Acciones"})]})}),e.jsx("tbody",{className:"bg-bg-secondary divide-y divide-border-color",children:o.map(t=>e.jsxs("tr",{children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-text-primary",children:[t.name," ",t.last_name]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-text-secondary",children:t.email}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-text-secondary",children:t.role}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>m(`/admin/users/edit/${t._id}`),className:"text-accent-primary hover:text-blue-700 mr-3",children:e.jsx(N,{})}),e.jsx("button",{onClick:()=>g(t._id),className:"text-red-600 hover:text-red-900",children:e.jsx(b,{})})]})]},t._id))})]})})]})]})}):e.jsxs("div",{className:"mt-28 p-8 min-h-[calc(100vh-80px)] bg-bg-primary text-text-primary text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4 text-red-500",children:"Acceso Denegado"}),e.jsx("p",{className:"text-lg",children:"No tienes permiso para ver esta página."})]})};export{k as default};
